<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Search Word</title>
  <style>
    /* Reset */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html,body { height: 100%; font-family: Arial, Helvetica, sans-serif; background:#f5f5f5; color:#202124; }

    /* Page center */
    .page {
      min-height: 100%;
      display:flex;
      align-items:center;
      justify-content:center;
      flex-direction:column;
      padding: 40px 20px;
    }

    /* Logo / title */
    .logo {
      font-size:48px;
      font-weight:700;
      letter-spacing: -2px;
      margin-bottom: 24px;
      display:flex;
      align-items:baseline;
      gap:12px;
    }
    .logo .title-main { color:#1a73e8; } /* google-like blue */
    .logo .title-sub { font-size:18px; color:#5f6368; }

    /* Search box */
    .search-wrap {
      width: 100%;
      max-width: 680px;
      display:flex;
      align-items:center;
      background: #fff;
      border-radius: 24px;
      padding: 12px 16px;
      box-shadow: 0 6px 18px rgba(60,64,67,0.15);
    }
    .search-wrap svg { width:22px; height:22px; margin-right:10px; opacity:0.7; }
    input.search {
      border: none;
      outline: none;
      font-size:20px;
      flex:1;
      min-width:0;
    }
    button.clear-btn {
      background:transparent;
      border:none;
      cursor:pointer;
      font-size:16px;
      color:#5f6368;
      padding:6px;
    }

    /* Results */
    .results {
      margin-top:14px;
      width:100%;
      max-width:680px;
      background:transparent;
    }
    .meta {
      color:#5f6368;
      font-size:13px;
      margin-bottom:8px;
      padding-left:6px;
    }
    .list {
      background:#fff;
      border-radius:8px;
      box-shadow: 0 4px 12px rgba(60,64,67,0.10);
      max-height:360px;
      overflow:auto;
      padding:6px;
    }
    .item {
      padding:10px 12px;
      border-radius:6px;
      cursor:pointer;
      display:flex;
      align-items:center;
      gap:10px;
      font-size:16px;
    }
    .item:hover, .item.active {
      background: #f1f3f4;
    }
    .highlight {
      background: linear-gradient(90deg, #fff59d 0%, #ffe082 100%);
      border-radius:3px;
      padding:0 2px;
    }

    /* Footer hint */
    .hint {
      margin-top:18px;
      color:#70757a;
      font-size:13px;
    }

    /* Responsive */
    @media (max-width:420px) {
      .logo { font-size:36px; }
      input.search { font-size:18px; }
    }
  </style>
</head>
<body>
  <div class="page">
    <div class="logo">
      <div class="title-main">Search</div>
      <div class="title-sub">word</div>
    </div>

    <div class="search-wrap" role="search" aria-label="Search words">
      <!-- Magnifier icon -->
      <svg viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zM10 14a4 4 0 110-8 4 4 0 010 8z"/></svg>

      <input id="q" class="search" type="search" placeholder="Cari kata..." autocomplete="off" aria-autocomplete="list" />

      <button id="clear" class="clear-btn" title="Clear" aria-label="Clear search">✕</button>
    </div>

    <div class="results" id="results">
      <div class="meta" id="meta" hidden></div>
      <div class="list" id="list" role="listbox" aria-label="Search results"></div>
    </div>

    <div class="hint">Tip: ketik beberapa huruf untuk menemukan kata. Gunakan panah ↑ ↓ lalu Enter untuk memilih.</div>
  </div>

  <script>
    // ====== Config ======
    const WORDS_FILE = 'words.txt'; // pastikan file ini tersedia di folder yang sama
    const MAX_RESULTS = 200;

    // ====== State ======
    let words = [];
    let filtered = [];
    let activeIndex = -1;
    const qEl = document.getElementById('q');
    const listEl = document.getElementById('list');
    const metaEl = document.getElementById('meta');
    const clearBtn = document.getElementById('clear');

    // Utility: debounce
    function debounce(fn, ms=150) {
      let t;
      return (...args) => {
        clearTimeout(t);
        t = setTimeout(() => fn(...args), ms);
      };
    }

    // Load words from words.txt
    fetch(WORDS_FILE)
      .then(r => {
        if (!r.ok) throw new Error('Gagal memuat ' + WORDS_FILE + ' (HTTP ' + r.status + ')');
        return r.text();
      })
      .then(txt => {
        words = txt.split(/\\r?\\n/).map(s => s.trim()).filter(Boolean);
        // optional: sort for safety (if not already sorted)
        words.sort((a,b) => a.localeCompare(b, undefined, {sensitivity:'base'}));
      })
      .catch(err => {
        console.error(err);
        metaEl.hidden = false;
        metaEl.textContent = 'Error: tidak bisa memuat words.txt — pastikan file ada di folder yang sama dan Anda membuka halaman via server lokal.';
      });

    // Highlight matched substring (case-insensitive)
    function highlightMatch(word, term) {
      if (!term) return escapeHtml(word);
      const idx = word.toLowerCase().indexOf(term.toLowerCase());
      if (idx === -1) return escapeHtml(word);
      const before = escapeHtml(word.slice(0, idx));
      const match = escapeHtml(word.slice(idx, idx + term.length));
      const after = escapeHtml(word.slice(idx + term.length));
      return before + '<span class="highlight">' + match + '</span>' + after;
    }

    function escapeHtml(s) {
      return s.replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;');
    }

    // Render results
    function renderResults(term) {
      listEl.innerHTML = '';
      activeIndex = -1;
      if (!term) {
        metaEl.hidden = true;
        return;
      }
      const tLow = term.toLowerCase();
      // Priority: startsWith first, then includes
      const starts = [];
      const includes = [];
      for (let w of words) {
        const lw = w.toLowerCase();
        if (lw.startsWith(tLow)) starts.push(w);
        else if (lw.includes(tLow)) includes.push(w);
        // stop early if large enough? we combine then slice below
      }
      filtered = starts.concat(includes).slice(0, MAX_RESULTS);
      // meta
      metaEl.hidden = false;
      metaEl.textContent = `${filtered.length} hasil${filtered.length===MAX_RESULTS? ' (maksimum ditampilkan)':''} untuk "${term}"`;

      if (filtered.length === 0) {
        listEl.innerHTML = '<div class="item" style="color:#70757a">Tidak ada hasil.</div>';
        return;
      }

      const frag = document.createDocumentFragment();
      filtered.forEach((w, i) => {
        const div = document.createElement('div');
        div.className = 'item';
        div.setAttribute('role','option');
        div.setAttribute('data-index', i);
        div.innerHTML = '<div style="flex:1">' + highlightMatch(w, term) + '</div>';
        div.addEventListener('click', () => selectItem(i));
        div.addEventListener('mousemove', () => setActive(i));
        frag.appendChild(div);
      });
      listEl.appendChild(frag);
    }

    function setActive(i) {
      if (activeIndex === i) return;
      const prev = listEl.querySelector('.item.active');
      if (prev) prev.classList.remove('active');
      const next = listEl.querySelector('.item[data-index="'+i+'"]');
      if (next) next.classList.add('active');
      activeIndex = i;
    }

    function selectItem(i) {
      const w = filtered[i];
      if (!w) return;
      qEl.value = w;
      renderResults(w);
      // scroll selected into view
      const el = listEl.querySelector('.item[data-index="'+i+'"]');
      if (el) el.scrollIntoView({block:'nearest'});
    }

    // Keyboard navigation
    qEl.addEventListener('keydown', (ev) => {
      if (ev.key === 'ArrowDown') {
        ev.preventDefault();
        if (filtered.length === 0) return;
        const next = (activeIndex + 1) % filtered.length;
        setActive(next);
        scrollActiveIntoView();
      } else if (ev.key === 'ArrowUp') {
        ev.preventDefault();
        if (filtered.length === 0) return;
        const prev = (activeIndex - 1 + filtered.length) % filtered.length;
        setActive(prev);
        scrollActiveIntoView();
      } else if (ev.key === 'Enter') {
        if (activeIndex >= 0) {
          ev.preventDefault();
          selectItem(activeIndex);
        }
      } else if (ev.key === 'Escape') {
        qEl.value = '';
        renderResults('');
      }
    });

    function scrollActiveIntoView() {
      const el = listEl.querySelector('.item.active');
      if (el) el.scrollIntoView({block:'nearest'});
    }

    // Input handler (debounced)
    const onInput = debounce(() => {
      const term = qEl.value.trim();
      renderResults(term);
    }, 120);

    qEl.addEventListener('input', onInput);

    // Clear button
    clearBtn.addEventListener('click', () => {
      qEl.value = '';
      qEl.focus();
      renderResults('');
    });

    // Click outside closes result meta (keeps list for visual)
    document.addEventListener('click', (ev) => {
      if (!ev.target.closest('.search-wrap') && !ev.target.closest('.list')) {
        // don't hide everything completely: just hide meta
        metaEl.hidden = true;
      }
    });

    // small accessibility: focus list when tabbing into it
    listEl.addEventListener('keydown', (ev) => {
      if (ev.key === 'Enter' && activeIndex >= 0) selectItem(activeIndex);
    });
  </script>
</body>
</html>